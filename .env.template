# ======================================================= #
# Ash-Bot v5.0 Environment Variables Template
# ======================================================= #
# FILE VERSION: v5.0.4
# LAST MODIFIED: 2026-01-04
# CLEAN ARCHITECTURE: Compliant
# Repository: https://github.com/the-alphabet-cartel/ash-bot
# Community: The Alphabet Cartel - https://discord.gg/alphabetcartel | https://alphabetcartel.org
#
# USAGE:
#   1. Copy this file to .env
#   2. Modify values as needed
#   3. Environment variables OVERRIDE JSON config defaults
#
# CONFIG FILES:
#   - src/config/default.json     (base configuration)
#   - src/config/production.json  (production overrides)
#   - src/config/testing.json     (testing overrides)
#
# ⚠️  SECRETS WARNING:
#   Do NOT put API tokens or passwords in this file!
#   Use Docker Secrets instead: ./secrets/
#   See secrets/README.md for setup instructions
#
# ------------------------------------------------------- #
# VARIABLE_NAME=value                                     # Description (default: X)
# ------------------------------------------------------- #
# ======================================================= #

# ======================================================= #
# GLOBAL VARIABLES
# ======================================================= #
# ------------------------------------------------------- #
# TIMEZONE - Used by Docker and the bot
# ------------------------------------------------------- #
TZ=America/Los_Angeles                                    # Server timezone (default: UTC)
# ------------------------------------------------------- #
# ======================================================= #

# ======================================================= #
# GENERAL CONFIGURATION
# ======================================================= #
# ------------------------------------------------------- #
# ENVIRONMENT SELECTION
# ------------------------------------------------------- #
BOT_ENVIRONMENT=production                                # Environment: production, testing (default: production)
#                                                         # Controls which JSON config overrides are loaded
# ------------------------------------------------------- #

# ------------------------------------------------------- #
# LOGGING CONFIGURATION
# Maps to: logging section in default.json
# ------------------------------------------------------- #
BOT_LOG_LEVEL=INFO                                        # Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL (default: INFO)
BOT_LOG_FORMAT=json                                       # Log format: json, text (default: json)
#                                                         # Use 'text' for development, 'json' for production
BOT_LOG_FILE=/app/logs/ash-bot.log                        # Log file path (default: /app/logs/ash-bot.log)
BOT_LOG_CONSOLE=true                                      # Output logs to console: true, false (default: true)
# ------------------------------------------------------- #
# ======================================================= #

# ======================================================= #
# DISCORD CONFIGURATION
# Maps to: discord, channels sections in default.json
# ======================================================= #
# ------------------------------------------------------- #
# GUILD (SERVER) SETTINGS
# ------------------------------------------------------- #
BOT_DISCORD_GUILD_ID=                                     # Discord guild/server ID (default: null = all guilds)
#                                                         # Leave empty for multi-guild, or set for single-guild mode
# ------------------------------------------------------- #

# ------------------------------------------------------- #
# CHANNEL SETTINGS
# Get channel IDs: Enable Developer Mode, right-click channel, Copy ID
# ------------------------------------------------------- #
BOT_MONITORED_CHANNELS=["123456789","987654321"]          # JSON array of channel IDs to monitor for messages
BOT_ALERT_CHANNEL_MONITOR=123456789                       # Channel ID for MEDIUM severity alerts
BOT_ALERT_CHANNEL_CRISIS=123456789                        # Channel ID for HIGH severity alerts
BOT_ALERT_CHANNEL_CRITICAL=123456789                      # Channel ID for CRITICAL severity alerts
# ------------------------------------------------------- #

# ------------------------------------------------------- #
# ROLE SETTINGS
# Get role ID: Enable Developer Mode, right-click role, Copy ID
# ------------------------------------------------------- #
BOT_CRT_ROLE_ID=123456789                                 # Crisis Response Team role ID for @mentions
#                                                         # HIGH and CRITICAL alerts ping this role
# ------------------------------------------------------- #
# ======================================================= #

# ======================================================= #
# ASH-NLP API CONFIGURATION
# Maps to: nlp section in default.json
# ======================================================= #
# ------------------------------------------------------- #
# CONNECTION SETTINGS
# ------------------------------------------------------- #
BOT_NLP_BASE_URL=http://ash-nlp:30880                     # Ash-NLP API base URL (default: http://ash-nlp:30880)
#                                                         # Use Docker container name when running in Docker
BOT_NLP_TIMEOUT=5                                         # API request timeout in seconds (default: 5)
BOT_NLP_RETRIES=2                                         # Number of retry attempts on failure (default: 2)
BOT_NLP_RETRY_DELAY=1                                     # Delay between retries in seconds (default: 1)
# ------------------------------------------------------- #
# ======================================================= #

# ======================================================= #
# REDIS CONFIGURATION
# Maps to: redis section in default.json
# ======================================================= #
# ------------------------------------------------------- #
# CONNECTION SETTINGS
# Note: Redis password should be in secrets/redis_token
# ------------------------------------------------------- #
BOT_REDIS_HOST=ash-redis                                  # Redis host (default: ash-redis)
#                                                         # Use Docker container name when running in Docker
BOT_REDIS_PORT=6379                                       # Redis port (default: 6379)
BOT_REDIS_DB=0                                            # Redis database number 0-15 (default: 0)
# ------------------------------------------------------- #
# ======================================================= #

# ======================================================= #
# USER HISTORY CONFIGURATION
# Maps to: history section in default.json
# ======================================================= #
# ------------------------------------------------------- #
# STORAGE SETTINGS
# ------------------------------------------------------- #
BOT_HISTORY_TTL_DAYS=14                                   # History retention in days (default: 14, prod: 30)
BOT_HISTORY_MAX_MESSAGES=100                              # Max messages stored per user (default: 100)
BOT_HISTORY_MIN_SEVERITY=low                              # Minimum severity to store: low, medium, high, critical
#                                                         # NOTE: SAFE/NONE messages are NEVER stored
# ------------------------------------------------------- #
# ======================================================= #

# ======================================================= #
# ALERTING CONFIGURATION
# Maps to: alerting section in default.json
# ======================================================= #
# ------------------------------------------------------- #
# ALERT SETTINGS
# ------------------------------------------------------- #
BOT_ALERTING_ENABLED=true                                 # Enable Discord alerting: true, false (default: true)
BOT_ALERT_MIN_SEVERITY=medium                             # Minimum severity to alert: medium, high, critical (default: medium)
#                                                         # MEDIUM → monitor channel (no ping)
#                                                         # HIGH/CRITICAL → crisis channel (with CRT ping)
BOT_ALERT_COOLDOWN=300                                    # Cooldown per user in seconds (default: 300)
#                                                         # Prevents alert spam from same user
# ------------------------------------------------------- #
# ======================================================= #

# ======================================================= #
# AUTO-INITIATE CONFIGURATION (Phase 7)
# Maps to: auto_initiate section in default.json
# ======================================================= #
# ------------------------------------------------------- #
# AUTO-INITIATE SETTINGS
# When CRT doesn't respond to an alert within the delay,
# Ash automatically reaches out to the user in crisis.
# ------------------------------------------------------- #
BOT_AUTO_INITIATE_ENABLED=true                            # Enable auto-initiation feature: true, false (default: true)
BOT_AUTO_INITIATE_DELAY_MINUTES=3                         # Minutes before auto-initiating (default: 3, range: 1-60)
#                                                         # This is how long to wait for CRT acknowledgment
BOT_AUTO_INITIATE_MIN_SEVERITY=medium                     # Minimum severity: low, medium, high, critical (default: medium)
#                                                         # Only alerts at or above this level trigger auto-initiate
# ------------------------------------------------------- #
# ======================================================= #

# ======================================================= #
# ASH PERSONALITY CONFIGURATION (Claude AI)
# Maps to: ash section in default.json
# ======================================================= #
# ------------------------------------------------------- #
# AI RESPONSE SETTINGS
# Note: Claude API key should be in secrets/claude_api_token
# ------------------------------------------------------- #
BOT_ASH_ENABLED=true                                      # Enable Ash AI responses: true, false (default: true)
BOT_ASH_MIN_SEVERITY=high                                 # Minimum severity for Ash: medium, high, critical (default: high)
#                                                         # MEDIUM → gentle check-in only
#                                                         # HIGH/CRITICAL → "Talk to Ash" DM session available
BOT_ASH_SESSION_TIMEOUT=300                               # Session inactivity timeout in seconds (default: 300)
#                                                         # Session ends after this much idle time
BOT_ASH_MAX_SESSION=600                                   # Maximum session duration in seconds (default: 600)
#                                                         # Session ends even if active after this time
BOT_ASH_MODEL=claude-sonnet-4-20250514                    # Claude model to use (default: claude-sonnet-4-20250514)
BOT_ASH_MAX_TOKENS=500                                    # Maximum tokens per Ash response (default: 500)
# ------------------------------------------------------- #
# ======================================================= #

# ======================================================= #
# HEALTH CHECK CONFIGURATION (Phase 5)
# Maps to: health section in default.json
# ======================================================= #
# ------------------------------------------------------- #
# HEALTH SERVER SETTINGS
# ------------------------------------------------------- #
BOT_HEALTH_ENABLED=true                                   # Enable health check server: true, false (default: true)
BOT_HEALTH_HOST=0.0.0.0                                   # Health server bind address (default: 0.0.0.0)
BOT_HEALTH_PORT=30881                                     # Health server port (default: 30881)
#
# Available Endpoints:
#   GET /health          - Simple liveness probe (always 200 if running)
#   GET /healthz         - Kubernetes liveness alias
#   GET /health/ready    - Readiness probe (200 if Discord connected)
#   GET /readyz          - Kubernetes readiness alias
#   GET /health/detailed - Full component status JSON
#   GET /metrics         - Prometheus-format metrics
# ------------------------------------------------------- #
# ======================================================= #

# ======================================================= #
# METRICS CONFIGURATION (Phase 5)
# Maps to: metrics section in default.json
# ======================================================= #
# ------------------------------------------------------- #
# METRICS COLLECTION SETTINGS
# ------------------------------------------------------- #
BOT_METRICS_ENABLED=true                                  # Enable metrics collection: true, false (default: true)
BOT_METRICS_INTERVAL=60                                   # Internal export interval in seconds (default: 60)
#                                                         # Does not affect /metrics endpoint availability
# ------------------------------------------------------- #
# ======================================================= #

# ======================================================= #
# CIRCUIT BREAKER CONFIGURATION (Phase 5)
# Maps to: circuit_breaker section in default.json
# ======================================================= #
# ------------------------------------------------------- #
# NLP API CIRCUIT BREAKER
# Prevents cascading failures when NLP service is down
# ------------------------------------------------------- #
BOT_CB_NLP_FAILURES=5                                     # Failures before circuit opens (default: 5)
BOT_CB_NLP_SUCCESSES=2                                    # Successes needed to close from half-open (default: 2)
BOT_CB_NLP_TIMEOUT=30                                     # Seconds before trying half-open (default: 30)
#
# Circuit States:
#   CLOSED    → Normal operation, requests pass through
#   OPEN      → Failing fast, returns fallback response (MEDIUM severity)
#   HALF_OPEN → Testing recovery, limited requests allowed
# ------------------------------------------------------- #

# ------------------------------------------------------- #
# REDIS CIRCUIT BREAKER
# Handles Redis connection failures gracefully
# ------------------------------------------------------- #
BOT_CB_REDIS_FAILURES=3                                   # Failures before circuit opens (default: 3)
BOT_CB_REDIS_TIMEOUT=15                                   # Seconds before trying half-open (default: 15)
#                                                         # Redis failures skip storage but don't block analysis
# ------------------------------------------------------- #
# ======================================================= #

# ======================================================= #
# ⚠️  SECRETS REMINDER
# ======================================================= #
# Do NOT put secrets in this file! Use Docker Secrets:
#
# Required:
#   secrets/discord_bot_token    - Discord bot token (from Developer Portal)
#   secrets/claude_api_token     - Claude API key (from Anthropic Console)
#
# Optional:
#   secrets/discord_alert_token  - Discord webhook URL for system alerts
#   secrets/redis_token          - Redis password (if authentication enabled)
#
# Example:
#   echo "your-secret-token" > secrets/discord_bot_token
#   chmod 600 secrets/discord_bot_token
#
# See secrets/README.md for full instructions
# ======================================================= #

# ======================================================= #
# END OF CONFIGURATION
# ======================================================= #
